DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'图书管理系统.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201806140013557_v1'
BEGIN
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201806140013557_v1', N'图书管理系统.Migrations.Configuration',  0x1F8B0800000000000400CD59CD6EE33610BE17E83B083AB540D68ABD976D20EF226B2785D1CD0F56D9BDD3D2D81142912A4965E317D873EF3D14BDF4D84B4F4580F6655AE4D857E850FF9625D972BC711020B028CEC7E1CC70F8F9F37FF77FDB6FEE026ADC82903E6743B3DF3B340D602EF77C361F9A919ABD7865BE79FDF557F68917DC191FB3792FF53CB46472685E2B151E599674AF2120B217F8AEE092CF54CFE581453C6E0D0E0FBFB3FA7D0B10C2442CC3B0DF474CF901C40FF838E2CC855045849E710FA84CC7F18D13A31AE7240019121786E6BF3FFFF5CF9FBF3DFCFEEBC34F9F1FFEB87FB8FFA5971899C631F5093AE4009D9906618C2BA2D0DDA30F121C25389B3B210E107AB50801E7CD0895906EE3A898BEE98E0E077A4756619841B991543CE808D87F9986C8AA9A6F1568330F2106F10483AD167AD7712087E6B117F8885B5DE96844859ED512E45E6C7A60AC4E38C8AB038B48FF1D18A388AA48C09041A404A107C66534A5BEFB032CAEF80DB0218B282D3B8AAEE2BBA5011CBA143C04A116EF6196BAAFFF4F3CD3B0966DADAA716E5AB14BF6882581456E1A67E4EE1DB0B9BAC6F21FBC328D53FF0EBC6C24AD910FCCC73381464A44F8788E8E932985FCBDD5BAEE2591F213176D2BE3C78D562E2F645B45625BD3FD96F39BEDB2AD2DF79C6CEDC236C9CEEC9E3AD957BEA2B0E34CAFAE721CA96B2EBEF83257582B345B65C2D4CB41E778388ABB375D203A94B510FCD3B685AD6DF75CDA9371F7B2D636EDB12C0502632FE07B60208802EF92280502AFA38907712CD7A56EED11FAA25D0B6F6DB15D72B5E573B8A2B6486F66F7D45D2BDCC71585B44F111FAB3375628428A7BE90AA5F93774C6A9A7A99AEB4BCA104D20155E638480A0B071266D84BC98FD56EAE6BBFCE3AB94BD71AEBEE526F9EF4AC3500BA82EBCC93335117E13C960577B612F29C916CAB8165DB67240C31D925D69D8E184E42B9472F9CEE243448302C57D670D1DCDB7C25EC54640E95B7A592181345A64497DBC80B9AA7F59BAA225B68A938AAE7B88877365D7F4E4CD650E22A5611C553DC58800D37DE23E40E652C7CC52EFED64328110DEC75C46914B03626DC865270D1324E31BA8A645B958D54A366AD84ADD2F4AA49D82845C901DC4D86E243DB3D41F5664D91CD6ECB725CEBC96B1B4A4A1FCB20E9D0E61819392C8364631D3C49B8DF9227C9D0E61829F92B63A443CFA8CE925EBDAB4A8BFBFB36B5566FD814594D12CA615D251B6DD6DD6A754F99492EC1DDE425BE38BB67A5DEACB5438F6B3A74A7DC84B51D3ADC57875E2118D529F9EA39D1A8100A3BBDDCD76B7B2BB77D32C5343044B7BEA76F7A672115043D3DA1E7FC4847D4C7FD1613CE08F3672055C2DECDC1617F50D1059F8F466749E9D14D84BABD4964EC9608F79A88D56F208F54C032E06F0272F76D19EDB12AD7DE04A69D856A493FEA10A7751AD1A3A09674205F1FB8C7A840EB01BA6A404F2EBEC45B582BAF740C527D45EDF28CACDE674F2967ECEC8C54D58A9D85AA5191C8BF7E6E203A346B0EC9753634BD2947D71317339D62033DA2518EA8C34D058C8D948A16A1A21E3A95373650311A458C3AE054F6D852DF58A519B655FEA1D11E83F4E70584FED99181ABEFEF02349B3361339E551DEEA8EC5136A5529467A0888765722C943F23AEC2D72E4819CB681F098D70CA4930056FC22E221546EA584A08A6744985B5ADF6F5631167D967FB22D44F72175B40377DDC025CB0B7914FBDDCEFD39A0EDD00A14F4CDA12D12B47E9D6385FE448E79C6D0894866F0C2130DD50AF20082982C90BE6905BD8C6372CAF773027EE22638BCD20EB13B11C767BEC93B920814C310A7B7CC41AF682BBD7FF0383E7F95C6F1F0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201806140018235_Initial'
BEGIN
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201806140018235_Initial', N'图书管理系统.Migrations.Configuration',  0x1F8B0800000000000400CD59CD6EE33610BE17E83B083AB540D68ABD976D20EF226B2785D1CD0F56D9BDD3D2D81142912A4965E317D873EF3D14BDF4D84B4F4580F6655AE4D857E850FF9625D972BC711020B028CEC7E1CC70F8F9F37FF77FDB6FEE026ADC82903E6743B3DF3B340D602EF77C361F9A919ABD7865BE79FDF557F68917DC191FB3792FF53CB46472685E2B151E599674AF2120B217F8AEE092CF54CFE581453C6E0D0E0FBFB3FA7D0B10C2442CC3B0DF474CF901C40FF838E2CC855045849E710FA84CC7F18D13A31AE7240019121786E6BF3FFFF5CF9FBF3DFCFEEBC34F9F1FFEB87FB8FFA5971899C631F5093AE4009D9906618C2BA2D0DDA30F121C25389B3B210E107AB50801E7CD0895906EE3A898BEE98E0E077A4756619841B991543CE808D87F9986C8AA9A6F1568330F2106F10483AD167AD7712087E6B117F8885B5DE96844859ED512E45E6C7A60AC4E38C8AB038B48FF1D18A388AA48C09041A404A107C66534A5BEFB032CAEF80DB0218B282D3B8AAEE2BBA5011CBA143C04A116EF6196BAAFFF4F3CD3B0966DADAA716E5AB14BF6882581456E1A67E4EE1DB0B9BAC6F21FBC328D53FF0EBC6C24AD910FCCC73381464A44F8788E8E932985FCBDD5BAEE2591F213176D2BE3C78D562E2F645B45625BD3FD96F39BEDB2AD2DF79C6CEDC236C9CEEC9E3AD957BEA2B0E34CAFAE721CA96B2EBEF83257582B345B65C2D4CB41E778388ABB375D203A94B510FCD3B685AD6DF75CDA9371F7B2D636EDB12C0502632FE07B60208802EF92280502AFA38907712CD7A56EED11FAA25D0B6F6DB15D72B5E573B8A2B6486F66F7D45D2BDCC71585B44F111FAB3375628428A7BE90AA5F93774C6A9A7A99AEB4BCA104D20155E638480A0B071266D84BC98FD56EAE6BBFCE3AB94BD71AEBEE526F9EF4AC3500BA82EBCC93335117E13C960577B612F29C916CAB8165DB67240C31D925D69D8E184E42B9472F9CEE243448302C57D670D1DCDB7C25EC54640E95B7A592181345A64497DBC80B9AA7F59BAA225B68A938AAE7B88877365D7F4E4CD650E22A5611C553DC58800D37DE23E40E652C7CC52EFED64328110DEC75C46914B03626DC865270D1324E31BA8A645B958D54A366AD84ADD2F4AA49D82845C901DC4D86E243DB3D41F5664D91CD6ECB725CEBC96B1B4A4A1FCB20E9D0E61819392C8364631D3C49B8DF9227C9D0E61829F92B63A443CFA8CE925EBDAB4A8BFBFB36B5566FD814594D12CA615D251B6DD6DD6A754F99492EC1DDE425BE38BB67A5DEACB5438F6B3A74A7DC84B51D3ADC57875E2118D529F9EA39D1A8100A3BBDDCD76B7B2BB77D32C5343044B7BEA76F7A672115043D3DA1E7FC4847D4C7FD1613CE08F3672055C2DECDC1617F50D1059F8F466749E9D14D84BABD4964EC9608F79A88D56F208F54C032E06F0272F76D19EDB12AD7DE04A69D856A493FEA10A7751AD1A3A09674205F1FB8C7A840EB01BA6A404F2EBEC45B582BAF740C527D45EDF28CACDE674F2967ECEC8C54D58A9D85AA5191C8BF7E6E203A346B0EC9753634BD2947D71317339D62033DA2518EA8C34D058C8D948A16A1A21E3A95373650311A458C3AE054F6D852DF58A519B655FEA1D11E83F4E70584FED99181ABEFEF02349B3361339E551DEEA8EC5136A5529467A0888765722C943F23AEC2D72E4819CB681F098D70CA4930056FC22E221546EA584A08A6744985B5ADF6F5631167D967FB22D44F72175B40377DDC025CB0B7914FBDDCEFD39A0EDD00A14F4CDA12D12B47E9D6385FE448E79C6D0894866F0C2130DD50AF20082982C90BE6905BD8C6372CAF773027EE22638BCD20EB13B11C767BEC93B920814C310A7B7CC41AF682BBD7FF0383E7F95C6F1F0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201806140042002_AutomaticMigration'
BEGIN
    ALTER TABLE [dbo].[Borrows] DROP CONSTRAINT [PK_dbo.Borrows]
    ALTER TABLE [dbo].[Borrows] ADD [NameID] [nvarchar](128) NOT NULL DEFAULT ''
    ALTER TABLE [dbo].[Borrows] ADD CONSTRAINT [PK_dbo.Borrows] PRIMARY KEY ([NameID])
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Borrows')
    AND col_name(parent_object_id, parent_column_id) = 'ID';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Borrows] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Borrows] DROP COLUMN [ID]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201806140042002_AutomaticMigration', N'图书管理系统.Migrations.Configuration',  0x1F8B0800000000000400ED59CD6EE33610BE17E83B083AB540D68A9DCB36907791B59322E83A0956D9BDD3D2D8114291AA4865ED17D873EF3D14BDF4D84B4F4580F6655AE4D857E850FFD69F2DC759A7401120B1A8998FC39921F9F9CB3FF77F9AAF171ED5EE20102E6743BDDF3BD4356036775C361FEAA19CBD78A9BF7EF5E517E6A9E32DB40FA9DD91B2434F2686FA8D94FEB16108FB063C227A9E6B075CF099ECD9DC3388C38DC1E1E13746BF6F0042E888A569E6BB9049D783E8011F479CD9E0CB90D00977808A641CDF5811AA76413C103EB161A8FFFDE31F7FFDFECBC3AF3F3FFCF0E9E1B7FB87FB9F7AB193AE9D5097604016D099AE11C6B82412C33D7E2FC092016773CBC70142AF973EA0DD8C5001C9328E73F34D577438502B3272C714CA0E85E45E47C0FE519222A3ECBE55A2F52C8598C4534CB65CAA5547891CEA278EE7226E79A6E3110D94554B927B91EB81563538C8BA039B48FD1C68A390CA308021835006841E6857E194BAF677B0BCE6B7C0862CA4B41828868AEF560670E82AE03E0472F90E6649F8EAF7B9A36BC6AAAF5176CE5C4B7EF11AB125B0C9756D42166F81CDE50DB6FFE0A5AE9DB90B70D291A447DE3317F7043AC920C4C70B0C9C4C2964EF8DD679AF88101F79D036337EDC68E6E244A69117B6B5DC6F38BFDDAEDACA73CFC556216C53ECD4EF7317FBDA9514765CE9EA2C27A1BCE1C1934F738DBD42D359CE993C1A74CE8725B97DDB05A2435B0701FFB86D632BDFE7708E8DB73CC7C69FBFB5D76EA9273DC5F0160FB62BB6F2FCBFD49D4AEDEFE3CA421A2889CB2048821821CA991B08D9AFA93B163529BD48665A5D500C69812C721E248979003153EC2564C8687757BD5FE71DDFAD6B9DD56953EF1E9F616B005407D7B9C77BA22EC3592E732E6DC4643A25DD4603EB3627C4F7B1D805169E8C68564CC1472FACEEA4D48B310C5BD470D32CDA6C26C9033287D2DB424B8C892453A2DA6DE478CD66FDA6AE48275A698EF23ECEF39D9AABCFB1CB1A8A5CC6CAB378860BF380C9688D900594B2F28A5FF42D88501234B0D911A7A1C7DA98711B4ACE4D8B38F96815C9344A0B2967CDA8A4AD74E8958BB05189E20DB89B0A459BB67B81EADD9A329BDE96C5BCD693D93694844E164192A1CD3152B2580449C73A441273C19548E2A1CD31123258C448869E519FC567F5AE3A2D3ADFB7E9B57AC7D6D3605C731A5448471B4AB79EDD5385E2CB7037F5892ED0EED5A9777BDADAF8B527B5BFAF93BA4234CA26D9EC19E128110B33B9E4D76B7E955B3F36D1354CD19DEBA81BDF5A0A095E4F19F4ACEFE988BAB8DEDC6042983B03216316AF0F0EFB83925EF87CB43B4308876E22E0ED4D3A637724B06F4850FD26F248652C05FECA238BAF8B688F55BFF6263CED2C552BBA52873CADD38E1E05B5A20FB96AC33D461D5A0FD0551BDADB37F59D95BDBE9B76B93FAA77D97F325165C56267A96A5425B2AFA01B080FCDBA437C950D7567CA31F438C454ABD84093689424EA7013116323B5A245ACA8874E248E0D948C4621A30E38913EB6D438AA14C3348AFF7C34C720DC790EA1FE15C9C05677770E9ADA9CB3194FBB0E57548C28352935E5042471B04D4E02E9CE882DF1B50D424452DA0742433439F5A6E09CB3CB50FAA13C1102BC295D16D76B1AEDF34742CE6ACCE6A5AF9EC42E968061BAB804B8646F42973A59DC6735A7730384DA31DF028E479CC892F817E6CB0CE982B30D8192F48DC107E620BFBB06CFA708262E9945EE609BD8B0BDDEC29CD8CB94293683AC2FC46ADACDB14BE601F1448291FBE323F6B0E32D5EFD0BE60124B5831F0000 , N'6.2.0-61023')
END

